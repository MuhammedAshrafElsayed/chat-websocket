<html>

<head>

</head>

<body>
    <div id="wrapper">
        <h1>Welcome to chat service!</h1>
        <div id="chatbox">
            <button id="connectButton">Connect</button>
            <span id="status">Disconnected</span>

            <ul id="messages"></ul>

            <form id="messageForm">
                <div>
                    <input type="text" id="messageInput" placeholder="Type your message here..." required />
                </div>
                <span id="error"></span>
                <button id="sendButton">Send</button>
                <button id="disconnectButton">Disconnect</button>
            </form>
        </div>
    </div>
</body>

<script>


    const connectButton = document.getElementById("connectButton");
    const disconnectButton = document.getElementById("disconnectButton");
    const submitButton = document.getElementById("messageForm");
    const messageInput = document.getElementById("messageInput");
    const errorSpan = document.getElementById("error");
    const statusSpan = document.getElementById("status");
    const messagesList = document.getElementById("messages");
    const messageForm = document.getElementById("messageForm");

    // const wsUrl = "ws://localhost:8080/chat";
    const wsUrl = "wss://echo.websocket.org";

    let socket = null;
    connectButton.addEventListener("click", (e) => {
        e.preventDefault();
        socket = new WebSocket(wsUrl);

        socket.addEventListener("open", (openEvent) => {
            console.log(`Connected to chat server at ${wsUrl}`);
            statusSpan.innerText = "Connected";
        });

        socket.addEventListener("close", (closeEvent) => {
            console.log(`Disconnected from chat server at ${wsUrl}`);
            statusSpan.innerText = "Disconnected";
            socket.close();
        });

        socket.addEventListener("error", (errorEvent) => {
        });

        socket.addEventListener("message", (msgEvent) => {
            const receivedMessage = msgEvent.data;
            const messageItem = document.createElement("li");
            messageItem.textContent = `Server: ${receivedMessage}`;
            messagesList.appendChild(messageItem);
        });
    });
    disconnectButton.addEventListener("click", (e) => {
        e.preventDefault();
        socket.close();
    });

    messageForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const message = messageInput.value;
        console.log(`Sending message: ${message}`);
        socket.send(message);
        messageInput.value = "";

        const messageItem = document.createElement("li");
        messageItem.textContent = `You: ${message}`;
        messagesList.appendChild(messageItem);
    });

</script>

</html>